{"version":3,"file":"digicode.min.js","sources":["../src/digicode.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Javascript for the digicode interface.\n *\n * @module     auth_digicode/digicode\n * @package    auth_digicode\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n// jshint unused: true, undef:true\ndefine(['jquery', 'core/log'], function($, log) {\n\n    var chronotime;\n    var chronodir;\n\n    var digicode = {\n        init: function(args) {\n            $('.digicode-digit').bind('mouseover', this.highlight_digit);\n            $('#digicode-panel').bind('mouseout', this.lightoff_digits);\n            $('.digicode-digit').bind('mousedown', this.add_digit);\n            $('.digicode-digit').bind('mouseup', this.release_digits);\n            $('#digicode-input').val(''); // Ensure it is empty at start.\n\n            if (args > 0) {\n                chronotime = args;\n                chronodir = 1;\n                $('#chrono-display').addClass('chrono-countup');\n            } else {\n                chronotime = -args;\n                chronodir = -1;\n                $('#chrono-display').addClass('chrono-countdown');\n            }\n\n            setInterval(this.chronotimer, 1000);\n\n            log.debug(\"ADM Digicode initialized\");\n        },\n\n        add_digit: function() {\n            var that = $(this);\n\n            var value = $('#digicode-input').val();\n            var shadow = $('#digicode-shadow').html();\n            value += that.html();\n            shadow += '*';\n            $('#digicode-input').val(value);\n            $('#digicode-shadow').html(shadow);\n            that.addClass('active');\n        },\n\n        highlight_digit: function() {\n            var that = $(this);\n\n            digicode.lightoff_digits();\n            that.addClass('highlighted');\n        },\n\n        lightoff_digits: function() {\n            $('.digicode-digit').removeClass('highlighted');\n        },\n\n        release_digits: function() {\n            $('.digicode-digit').removeClass('active');\n        },\n\n        chronotimer: function() {\n\n            log.debug(chronotime + \" \" + chronodir);\n            chronotime += chronodir;\n\n            var h = Math.floor(chronotime / 3600);\n            var rawm = chronotime - (h * 3600);\n            var m = Math.floor(rawm / 60);\n            var s = rawm - (m * 60);\n            var ht, mt, st;\n\n            log.debug(h + ' ' + rawm + ' ' + m + ' ' + s);\n\n            if (h < 10) {\n                ht = '0' + h;\n            } else {\n                ht = h;\n            }\n\n            if (m < 10){\n                 mt = '0' + m;\n            } else {\n               mt = m;\n            }\n\n            if (s < 10){\n                st = '0' + s;\n            } else {\n                st = s;\n            }\n\n            $('#chrono-display').html(ht + ':' + mt + ':' + st);\n\n        },\n\n    };\n\n    return digicode;\n});\n"],"names":["define","$","log","chronotime","chronodir","digicode","init","args","bind","this","highlight_digit","lightoff_digits","add_digit","release_digits","val","addClass","setInterval","chronotimer","debug","that","value","shadow","html","removeClass","ht","mt","st","h","Math","floor","rawm","m","s"],"mappings":";;;;;;;AAuBAA,OAAM,yBAAC,CAAC,SAAU,aAAa,SAASC,EAAGC,KAEvC,IAAIC,WACAC,UAEAC,SAAW,CACXC,KAAM,SAASC,MACXN,EAAE,mBAAmBO,KAAK,YAAaC,KAAKC,iBAC5CT,EAAE,mBAAmBO,KAAK,WAAYC,KAAKE,iBAC3CV,EAAE,mBAAmBO,KAAK,YAAaC,KAAKG,WAC5CX,EAAE,mBAAmBO,KAAK,UAAWC,KAAKI,gBAC1CZ,EAAE,mBAAmBa,IAAI,IAErBP,KAAO,GACPJ,WAAaI,KACbH,UAAY,EACZH,EAAE,mBAAmBc,SAAS,oBAE9BZ,YAAcI,KACdH,WAAa,EACbH,EAAE,mBAAmBc,SAAS,qBAGlCC,YAAYP,KAAKQ,YAAa,KAE9Bf,IAAIgB,MAAM,2BACb,EAEDN,UAAW,WACP,IAAIO,KAAOlB,EAAEQ,MAETW,MAAQnB,EAAE,mBAAmBa,MAC7BO,OAASpB,EAAE,oBAAoBqB,OACnCF,OAASD,KAAKG,OACdD,QAAU,IACVpB,EAAE,mBAAmBa,IAAIM,OACzBnB,EAAE,oBAAoBqB,KAAKD,QAC3BF,KAAKJ,SAAS,SACjB,EAEDL,gBAAiB,WACb,IAAIS,KAAOlB,EAAEQ,MAEbJ,SAASM,kBACTQ,KAAKJ,SAAS,cACjB,EAEDJ,gBAAiB,WACbV,EAAE,mBAAmBsB,YAAY,cACpC,EAEDV,eAAgB,WACZZ,EAAE,mBAAmBsB,YAAY,SACpC,EAEDN,YAAa,WAETf,IAAIgB,MAAMf,WAAa,IAAMC,WAC7BD,YAAcC,UAEd,IAIIoB,GAAIC,GAAIC,GAJRC,EAAIC,KAAKC,MAAM1B,WAAa,MAC5B2B,KAAO3B,WAAkB,KAAJwB,EACrBI,EAAIH,KAAKC,MAAMC,KAAO,IACtBE,EAAIF,KAAY,GAAJC,EAGhB7B,IAAIgB,MAAMS,EAAI,IAAMG,KAAO,IAAMC,EAAI,IAAMC,GAGvCR,GADAG,EAAI,GACC,IAAMA,EAENA,EAIJF,GADDM,EAAI,GACE,IAAMA,EAERA,EAIJL,GADAM,EAAI,GACC,IAAMA,EAENA,EAGT/B,EAAE,mBAAmBqB,KAAKE,GAAK,IAAMC,GAAK,IAAMC,GAEpD,GAIJ,OAAOrB,QACX"}